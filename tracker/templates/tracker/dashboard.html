{% extends 'tracker/base.html' %}
{% block title %}Dashboard - Fitrack{% endblock %}

{% block content %}
<style>
  /* === GENERAL LAYOUT === */
  .dashboard-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 1.5rem;
  }
  @media (min-width: 768px) {
    .dashboard-grid { grid-template-columns: repeat(3, 1fr); }
  }

  .card {
    position: relative;
    background: rgba(255,255,255,0.04);
    border: 1px solid rgba(255,255,255,0.06);
    backdrop-filter: blur(8px);
    border-radius: 1rem;
    padding: 1.6rem;
    box-shadow: 0 6px 20px rgba(0,0,0,0.35);
  }

  /* === PROFILE HEADER === */
  .profile-header {
    display:flex;
    gap:1.5rem;
    align-items:center;
    background: linear-gradient(90deg, rgba(0,255,200,0.06), rgba(0,180,255,0.05));
    padding:1.5rem;
    border-radius:16px;
    margin-bottom:1.5rem;
    border:1px solid rgba(255,255,255,0.04);
  }

  .profile-avatar {
    width:90px;
    height:90px;
    border-radius:14px;
    overflow:hidden;
    background:linear-gradient(90deg,#00b4ff,#00ffc8);
    display:grid;
    place-items:center;
    font-weight:800;
    color:#001;
    font-size:1.8rem;
    box-shadow:0 8px 20px rgba(0,180,255,0.18);
  }

  .profile-avatar img {
    width:100%;
    height:100%;
    object-fit:cover;
    border-radius:14px;
  }

  .profile-meta { display:flex;flex-direction:column; gap:0.3rem; }
  .profile-meta .name { font-weight:700; color:#eafff5; font-size:1.2rem; }
  .profile-meta .sub { color:#bcd6df; font-size:0.95rem; }

  /* === PROFILE STATS (styled + aligned) === */
  .profile-stats {
    margin-left:auto;
    display:flex;
    gap:1.5rem;
    align-items:center;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255,255,255,0.1);
    padding: 0.8rem 1.2rem;
    border-radius: 0.8rem;
    box-shadow: 0 0 10px rgba(0,255,200,0.15);
    backdrop-filter: blur(6px);
  }

  .profile-stat {
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    min-width:0; /* allow shrinking on small screens */
    padding: 0.5rem 0.7rem;
    border-radius:0.6rem;
    background: rgba(0,255,200,0.08);
    transition: all 0.3s ease;
    flex: 0 1 auto;
  }

  .profile-stat:hover {
    background: rgba(0,255,200,0.15);
    transform: scale(1.05);
    box-shadow: 0 0 12px rgba(0,255,200,0.25);
  }

  .profile-stat .num {
    font-weight:800;
    color:#00ffc8;
    font-size:1.2rem;
    letter-spacing: 0.5px;
  }

  .profile-stat .label {
    color:#bcd6df;
    font-size:0.85rem;
    margin-top:0.25rem;
  }

  /* === QUICK LINKS === */
  .quick-links-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 1.2rem;
    margin-top: 1rem;
  }

  .quicklink-card {
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    padding: 2rem 1rem;
  }

  .quicklink-card a {
    text-decoration: none;
    color: #eafcff;
    font-weight: 600;
    font-size: 1.1rem;
    display: block;
    width: 100%;
    text-align: center;
    transition: color 0.2s ease;
    white-space: nowrap;
  }

  .quicklink-card a:hover {
    color: #00ffc8;
  }
</style>

<!-- === PROFILE HEADER === -->
<div class="profile-header">
  <div class="profile-avatar">
    {% if profile.profile_picture %}
      <img src="{{ profile.profile_picture.url }}" alt="Profile Picture">
    {% elif profile and profile.name %}
      {{ profile.name|slice:":1"|upper }}
    {% else %}
      U
    {% endif %}
  </div>

  <div class="profile-meta">
    <div class="name">
      {% if profile and profile.name %}
        {{ profile.name }}
      {% else %}
        Your profile
      {% endif %}
    </div>
    <div class="sub">
      {% if profile and profile.age %}
        Age: {{ profile.age }}
      {% else %}
        Add age in your profile
      {% endif %}
      •
      {% if profile and profile.height_cm %}
        Height: {{ profile.height_cm }} cm
      {% else %}
        Add height in profile
      {% endif %}
    </div>
    <div class="sub" style="margin-top:6px;">
      <a href="{% url 'tracker:profile' %}" class="btn-outline">Edit profile</a>
    </div>
  </div>

  <!-- ✨ Updated Stylish Stats Section -->
  <div class="profile-stats">
    <div class="profile-stat">
      <div class="num">{{ daily_calorie_goal }}</div>
      <div class="label">Calorie Goal</div>
    </div>
    <div class="profile-stat">
      <div class="num">{{ water_goal_glasses }}</div>
      <div class="label">Water (Glasses)</div>
    </div>
  </div>
</div>

<!-- === DASHBOARD METRICS === -->
<div class="dashboard-grid">
  <div class="card">
    <div class="text-sm muted">Today's Calories</div>
    <div class="text-3xl font-bold mt-1" style="color:#00ffc8;">{{ total_calories }} kcal</div>
    <div class="small muted">Goal: {{ daily_calorie_goal }} kcal</div>
    <div class="mt-4">
      <a href="{% url 'tracker:meal_add' %}" class="btn-primary">Log Meal</a>
    </div>
  </div>

  <div class="card">
    <div class="text-sm muted">Today's Workouts</div>
    <div class="text-3xl font-bold mt-1" style="color:#00b4ff;">{{ workouts_count }}</div>
    <div class="mt-4">
      <a href="{% url 'tracker:workout_add' %}" class="btn-primary">Log Workout</a>
    </div>
  </div>

  <div class="card">
    <div class="text-sm muted">Latest Weight</div>
    <div class="text-3xl font-bold mt-1" style="color:#ff8c00;">
      {% if latest_weight %}{{ latest_weight.weight }} kg{% else %}—{% endif %}
    </div>
    <div class="mt-4">
      <a href="{% url 'tracker:weight_add' %}" class="btn-primary">Add Weight</a>
    </div>
  </div>
</div>

<!-- === QUICK LINKS SECTION === -->
<div style="margin-top:2rem;">
  <h3 style="color:var(--accent-teal);margin-bottom:1rem;">Quick Links</h3>
  <div class="quick-links-grid">
    <div class="card quicklink-card"><a href="{% url 'tracker:workout_add' %}">Add Workout</a></div>
    <div class="card quicklink-card"><a href="{% url 'tracker:meal_add' %}">Add Meal</a></div>
    <div class="card quicklink-card"><a href="{% url 'tracker:weight_add' %}">Add Weight</a></div>
    <div class="card quicklink-card"><a href="{% url 'tracker:workout_list' %}">View Workouts</a></div>
    <div class="card quicklink-card"><a href="{% url 'tracker:meal_list' %}">View Meals</a></div>
    <div class="card quicklink-card"><a href="{% url 'tracker:weight_list' %}">View Weight History</a></div>
  </div>
</div>

<!-- === WATER TRACKER === -->
<div style="margin-top:2rem;">
  <div class="card">
    <h3 style="color:var(--accent-teal);margin-bottom:0.8rem;">Water Tracker</h3>
    <div class="small muted">Goal: {{ water_goal_glasses }} glasses</div>
    <div style="margin-top:0.8rem;">
      <div id="waterBar" style="height:10px;width:100%;background:rgba(255,255,255,0.04);border-radius:8px;overflow:hidden;">
        <div id="waterFill" style="height:100%;width:30%;background:linear-gradient(90deg,#00b4ff,#00ffc8);"></div>
      </div>
      <p class="muted small" style="margin-top:0.8rem;">Water counter is display-only in this demo.</p>
    </div>
  </div>
</div>
{% endblock %}
